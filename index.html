<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Mapa com KML e Imagem</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
    #search-box {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      padding: 6px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      z-index: 1000;
      font-family: Arial, sans-serif;
    }
    #search-box input {
      width: 180px;
      padding: 4px;
    }
    #search-box button {
      padding: 4px 8px;
      margin-left: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div id="map"></div>

<div id="search-box">
  <input type="text" id="coords" placeholder="lat, lon">
  <button onclick="goToCoords()">Ir</button>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-omnivore/leaflet-omnivore.min.js"></script>

<script>
  // Cria o mapa
  var map = L.map('map').setView([-15.5, -47.5], 4);

  // Camada base (apenas países, sem divisões internas)
  L.tileLayer('https://cartodb-basemaps-a.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}{r}.png', {
    attribution: '© OpenStreetMap contributors © CARTO'
  }).addTo(map);

  // Carrega o KML
  omnivore.kml('isopletas.kml').addTo(map);

  // Sobreposição da imagem
  var imageUrl = "isopletas2-sf.png";
  var imageBounds = [[-36, -75], [10, -32]]; 
  L.imageOverlay(imageUrl, imageBounds).addTo(map);

  // Função para ir até coordenada digitada
  var marker;
  function goToCoords() {
    var input = document.getElementById("coords").value;
    var parts = input.split(",");
    if (parts.length === 2) {
      var lat = parseFloat(parts[0].trim());
      var lon = parseFloat(parts[1].trim());
      if (!isNaN(lat) && !isNaN(lon)) {
        map.setView([lat, lon], 8);
        if (marker) map.removeLayer(marker);
        marker = L.marker([lat, lon]).addTo(map)
          .bindPopup("Coordenada: " + lat + ", " + lon)
          .openPopup();
      } else {
        alert("Digite valores válidos (ex: -23.5, -46.6)");
      }
    } else {
      alert("Formato inválido! Use: lat, lon");
    }
  }
</script>
</body>
</html>


