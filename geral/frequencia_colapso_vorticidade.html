<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Frequência de Colapso de Vorticidade</title>
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
    body{margin:0;height:100vh;display:flex;flex-direction:column}
    header{background:#0b3d91;color:#fff;padding:12px 20px;box-shadow:0 2px 6px rgba(0,0,0,.15)}
    header h1{margin:0;font-size:18px}
    .subtitle{font-size:13px;opacity:.9}
    .wrap{flex:1;display:flex}
    .panel{width:50%;padding:20px;box-sizing:border-box;overflow:auto}
    .left{background:linear-gradient(180deg,#f7f9ff,#ffffff)}
    .right{background:#fff}

    /* alinhamento dos campos */
    .field{
      display:flex;
      align-items:center;
      margin-top:12px;
    }
    .field label{
      width:240px;       /* largura fixa para todos os rótulos */
      font-weight:600;
    }
    .field input{
      flex:1;
      max-width:160px;
      padding:8px;
      border:1px solid #ccd;
      border-radius:6px;
    }

    .btn{margin-top:16px;padding:10px 14px;border:0;background:#0b5ed7;color:#fff;border-radius:8px;cursor:pointer;font-weight:700}
    .result{margin-top:16px;padding:12px;background:#eef6ff;border-radius:8px;border:1px solid #d6e8ff}
    small.note{display:block;margin-top:8px;color:#333;opacity:.8}
    footer{padding:8px 16px;font-size:13px;color:#555;background:#fafafa;border-top:1px solid #eee}
    @media(max-width:900px){.wrap{flex-direction:column}.panel{width:100%;height:50vh}}
  </style>
</head>
<body>
  <header>
    <h1>Frequência de Colapso de Vorticidade</h1>
    <div class="subtitle">L = c·sin(θ) e f = st·u / L</div>
  </header>

  <div class="wrap">
    <section class="panel left">
      <h2>Entradas</h2>
      
      <div class="field">
        <label for="u">Velocidade (u) — m/s</label>
        <input id="u" type="number" step="0.1" value="35" min="0" />
      </div>

      <div class="field">
        <label for="c">Comp. característico (c) — m</label>
        <input id="c" type="number" step="0.01" value="4.4" min="0" />
      </div>

      <div class="field">
        <label for="st">st (número de Strouhal)</label>
        <input id="st" type="number" step="0.001" value="0.15" min="0" />
      </div>

      <div class="field">
        <label for="theta">Ângulo das placas θ — graus</label>
        <input id="theta" type="number" step="0.1" value="20" min="0" max="90" />
      </div>

      <button class="btn" id="calcBtn">Calcular e Atualizar Gráfico</button>

      <div class="result" id="output">
        <div><strong>L</strong> = <span id="Lval">–</span> m</div>
        <div style="margin-top:8px"><strong>f</strong> = <span id="fval">–</span> Hz <small class="note">(frequência de colapso de vorticidade)</small></div>
      </div>
    </section>

    <section class="panel right">
      <h2>Frequência do Colapso de Vorticidade(Hz) vs Velocidade do Vento(m/s)</h2>
      <div id="plot" style="width:100%;height:78%;min-height:360px"></div>
      <p style="margin-top:8px">Curvas traçadas para u ∈ [0,50] m/s e θ = 5°, 10°, 15°, 20°, 25°, 30°. O ponto correspondente às entradas atuais é marcado na curva do θ selecionado.</p>
    </section>
  </div>

  

  <script>
    const toRad = a => a * Math.PI / 180;
    function computeL(c, thetaDeg){ return c * Math.sin(toRad(thetaDeg)); }
    function computeF(st, u, L){ if (L === 0) return NaN; return st * u / L; }

    const thetas = [5,10,15,20,25,30];
    const uMin = 0, uMax = 50, uStep = 0.5;
    const uArray = []; for(let uu=uMin; uu<=uMax+1e-9; uu+=uStep) uArray.push(Math.round(uu*100)/100);

    function makeTraces(c, st){
      return thetas.map(theta => {
        const L = computeL(c, theta);
        const y = uArray.map(u=> computeF(st, u, L));
        return {x: uArray,y: y,name: `θ = ${theta}° (L=${L.toFixed(3)} m)`,mode: 'lines'};
      });
    }

    function initPlot(){
      const c0 = parseFloat(document.getElementById('c').value);
      const st0 = parseFloat(document.getElementById('st').value);
      Plotly.newPlot('plot', makeTraces(c0, st0), {xaxis:{title:'u (m/s)'},yaxis:{title:'f (Hz)'}}, {responsive:true});
    }

    function updatePlotHighlight(thetaSel, uSel, cVal, stVal){
      const plotDiv = document.getElementById('plot');
      const pointTrace = {
        x: [uSel], y: [ computeF(stVal, uSel, computeL(cVal, thetaSel)) ],
        name: `Ponto`, mode: 'markers+text',
        text: [`f=${(computeF(stVal,uSel,computeL(cVal,thetaSel))).toFixed(4)} Hz`],
        textposition: 'top center',
        marker: {size:10, symbol:'circle-open', line: {width:2}}
      };
      const newData = plotDiv.data.filter(t=> !(t.name && t.name.startsWith('Ponto')));
      Plotly.react('plot', [...newData, pointTrace], plotDiv.layout, {responsive:true});
    }

    function calculateAndUpdate(){
      const u = parseFloat(document.getElementById('u').value);
      const c = parseFloat(document.getElementById('c').value);
      const st = parseFloat(document.getElementById('st').value);
      const theta = parseFloat(document.getElementById('theta').value);
      const L = computeL(c, theta); const f = computeF(st, u, L);
      document.getElementById('Lval').textContent = isFinite(L) ? L.toFixed(4) : '–';
      document.getElementById('fval').textContent = isFinite(f) ? f.toFixed(6) : '–';
      Plotly.react('plot', makeTraces(c, st), document.getElementById('plot').layout, {responsive:true})
        .then(()=> updatePlotHighlight(theta, u, c, st));
    }

    document.getElementById('calcBtn').addEventListener('click', calculateAndUpdate);
    window.addEventListener('load', ()=>{initPlot(); calculateAndUpdate();});
  </script>
</body>
</html>

